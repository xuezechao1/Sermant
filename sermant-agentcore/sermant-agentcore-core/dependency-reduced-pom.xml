<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
  <parent>
    <artifactId>sermant-agentcore</artifactId>
    <groupId>com.huaweicloud.sermant</groupId>
    <version>0.4.0-SNAPSHOT</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <artifactId>sermant-agentcore-core</artifactId>
  <name>sermant-agentcore-core</name>
  <description>The core capability and agent framework of Sermant.</description>
  <url>https://github.com/huaweicloud/Sermant</url>
  <developers>
    <developer>
      <id>luanwenfei-venus</id>
      <name>luanwenfei</name>
      <email>luanwenfei@outlook.com</email>
      <roles>
        <role>Developer</role>
      </roles>
      <timezone>+8</timezone>
    </developer>
  </developers>
  <licenses>
    <license>
      <name>Apache License, Version 2.0</name>
      <url>http://www.apache.org/licenses/LICENSE-2.0.html</url>
      <distribution>repo</distribution>
    </license>
  </licenses>
  <scm>
    <connection>scm:git:git://github.com/huaweicloud/Sermant.git</connection>
    <developerConnection>scm:git:ssh://github.com:huaweicloud/Sermant.git</developerConnection>
    <url>https://github.com/huaweicloud/Sermant</url>
  </scm>
  <build>
    <extensions>
      <extension>
        <groupId>kr.motd.maven</groupId>
        <artifactId>os-maven-plugin</artifactId>
        <version>${os.plugin.version}</version>
      </extension>
    </extensions>
    <plugins>
      <plugin>
        <artifactId>maven-jar-plugin</artifactId>
        <version>${jar.plugin.version}</version>
        <configuration>
          <archive>
            <manifestEntries>
              <Sermant-Version>${project.version}</Sermant-Version>
            </manifestEntries>
          </archive>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>${compiler.plugin.version}</version>
        <configuration>
          <source>8</source>
          <target>8</target>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-shade-plugin</artifactId>
        <version>${shade.plugin.version}</version>
        <executions>
          <execution>
            <phase>package</phase>
            <goals>
              <goal>shade</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <relocations>
            <relocation>
              <pattern>ch.qos.logback</pattern>
              <shadedPattern>${shade.common.prefix}.ch.qos.logback</shadedPattern>
            </relocation>
            <relocation>
              <pattern>net.bytebuddy</pattern>
              <shadedPattern>${shade.common.prefix}.net.bytebuddy</shadedPattern>
            </relocation>
            <relocation>
              <pattern>com.alibaba</pattern>
              <shadedPattern>${shade.common.prefix}.com.alibaba</shadedPattern>
            </relocation>
            <relocation>
              <pattern>com.github</pattern>
              <shadedPattern>${shade.common.prefix}.com.github</shadedPattern>
            </relocation>
            <relocation>
              <pattern>com.google</pattern>
              <shadedPattern>${shade.common.prefix}.com.google</shadedPattern>
            </relocation>
            <relocation>
              <pattern>google.protobuf</pattern>
              <shadedPattern>${shade.common.prefix}.google.protobuf</shadedPattern>
            </relocation>
            <relocation>
              <pattern>io.netty</pattern>
              <shadedPattern>${shade.common.prefix}.io.netty</shadedPattern>
            </relocation>
            <relocation>
              <pattern>javax.ws.rs</pattern>
              <shadedPattern>${shade.common.prefix}.javax.ws.rs</shadedPattern>
            </relocation>
            <relocation>
              <pattern>javax.inject</pattern>
              <shadedPattern>${shade.common.prefix}.javax.inject</shadedPattern>
            </relocation>
            <relocation>
              <pattern>javax.xml</pattern>
              <shadedPattern>${shade.common.prefix}.javax.xml</shadedPattern>
            </relocation>
            <relocation>
              <pattern>net.jpountz</pattern>
              <shadedPattern>${shade.common.prefix}.net.jpountz</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.aopalliance</pattern>
              <shadedPattern>${shade.common.prefix}.org.aopalliance</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.apache</pattern>
              <shadedPattern>${shade.common.prefix}.org.apache</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.java_websocket</pattern>
              <shadedPattern>${shade.common.prefix}.org.java_websocket</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.slf4j</pattern>
              <shadedPattern>${shade.common.prefix}.org.slf4j</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.w3c</pattern>
              <shadedPattern>${shade.common.prefix}.org.w3c</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.xerial</pattern>
              <shadedPattern>${shade.common.prefix}.org.xerial</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.xml</pattern>
              <shadedPattern>${shade.common.prefix}.org.xml</shadedPattern>
            </relocation>
            <relocation>
              <pattern>org.yaml</pattern>
              <shadedPattern>${shade.common.prefix}.org.yaml</shadedPattern>
            </relocation>
          </relocations>
          <transformers>
            <transformer />
            <transformer />
          </transformers>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.xolstice.maven.plugins</groupId>
        <artifactId>protobuf-maven-plugin</artifactId>
        <version>${protubuf.plugin.version}</version>
        <executions>
          <execution>
            <goals>
              <goal>compile</goal>
              <goal>compile-custom</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <protocArtifact>com.google.protobuf:protoc:${protobuf.version}:exe:${os.detected.classifier}</protocArtifact>
          <pluginId>grpc-java</pluginId>
          <pluginArtifact>io.grpc:protoc-gen-grpc-java:${grpc.version}:exe:${os.detected.classifier}</pluginArtifact>
        </configuration>
      </plugin>
      <plugin>
        <artifactId>maven-source-plugin</artifactId>
        <version>${source.plugin.version}</version>
        <executions>
          <execution>
            <id>attach-sources</id>
            <goals>
              <goal>jar-no-fork</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
    </plugins>
  </build>
  <profiles>
    <profile>
      <id>release</id>
      <properties>
        <os.detected.name>osx</os.detected.name>
        <os.detected.classifier>osx-x86_64</os.detected.classifier>
        <os.detected.arch>x86_64</os.detected.arch>
      </properties>
    </profile>
    <profile>
      <id>agent</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-shade-plugin</artifactId>
            <configuration>
              <outputFile>${package.temp.dir}/agent/core/${project.artifactId}-${project.version}.jar</outputFile>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>example</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-shade-plugin</artifactId>
            <configuration>
              <outputFile>${package.temp.dir}/agent/core/${project.artifactId}-${project.version}.jar</outputFile>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
    <profile>
      <id>all</id>
      <build>
        <plugins>
          <plugin>
            <artifactId>maven-shade-plugin</artifactId>
            <configuration>
              <outputFile>${package.temp.dir}/agent/core/${project.artifactId}-${project.version}.jar</outputFile>
            </configuration>
          </plugin>
        </plugins>
      </build>
    </profile>
  </profiles>
  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.12</version>
      <scope>test</scope>
      <exclusions>
        <exclusion>
          <artifactId>hamcrest-core</artifactId>
          <groupId>org.hamcrest</groupId>
        </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>org.mockito</groupId>
      <artifactId>mockito-inline</artifactId>
      <version>3.9.0</version>
      <scope>test</scope>
      <exclusions>
        <exclusion>
          <artifactId>mockito-core</artifactId>
          <groupId>org.mockito</groupId>
        </exclusion>
      </exclusions>
    </dependency>
    <dependency>
      <groupId>org.apache.commons</groupId>
      <artifactId>commons-io</artifactId>
      <version>1.3.2</version>
      <scope>compile</scope>
    </dependency>
    <dependency>
      <groupId>com.google.inject.extensions</groupId>
      <artifactId>guice-grapher</artifactId>
      <version>4.2.3</version>
      <scope>test</scope>
      <exclusions>
        <exclusion>
          <artifactId>guice-assistedinject</artifactId>
          <groupId>com.google.inject.extensions</groupId>
        </exclusion>
      </exclusions>
    </dependency>
  </dependencies>
  <properties>
    <logback.version>1.2.9</logback.version>
    <gpg.plugin.version>3.0.1</gpg.plugin.version>
    <junit.version>4.12</junit.version>
    <sermant.basedir>${pom.basedir}/../..</sermant.basedir>
    <jdk.version>1.8</jdk.version>
    <jar.plugin.version>3.2.0</jar.plugin.version>
    <guice.version>4.2.3</guice.version>
    <asm.version>8.0.1</asm.version>
    <source.plugin.version>3.0.1</source.plugin.version>
    <grpc.version>1.36.1</grpc.version>
    <javadoc.plugin.version>3.3.2</javadoc.plugin.version>
    <lombok.version>1.18.10</lombok.version>
    <compiler.plugin.version>3.8.1</compiler.plugin.version>
    <fastjson.version>1.2.76</fastjson.version>
    <shade.plugin.version>3.2.4</shade.plugin.version>
    <byte.buddy.version>1.10.14</byte.buddy.version>
    <commons-collections.version>4.4</commons-collections.version>
    <netty.version>4.1.73.Final</netty.version>
    <snake.yaml.version>1.26</snake.yaml.version>
    <http.core.version>4.4.13</http.core.version>
    <http.client.version>4.5.13</http.client.version>
    <xerces.version>2.12.1</xerces.version>
    <xml.apis.version>1.4.01</xml.apis.version>
    <protobuf.version>3.17.3</protobuf.version>
    <log4j2.version>2.17.1</log4j2.version>
    <mockito-inline.version>3.9.0</mockito-inline.version>
    <Java-WebSocket.version>1.5.1</Java-WebSocket.version>
    <common.io.version>1.3.2</common.io.version>
    <os.plugin.version>1.5.0.Final</os.plugin.version>
    <package.temp.dir>${sermant.basedir}/${sermant.name}-${project.version}</package.temp.dir>
    <commons-lang3.version>3.12.0</commons-lang3.version>
    <slf4j.version>1.7.35</slf4j.version>
    <nexus.staging.plugin.version>1.6.7</nexus.staging.plugin.version>
    <protubuf.plugin.version>0.5.1</protubuf.plugin.version>
    <zookeeper.version>3.6.0</zookeeper.version>
    <shade.common.prefix>com.huaweicloud.sermant.dependencies</shade.common.prefix>
  </properties>
</project>
